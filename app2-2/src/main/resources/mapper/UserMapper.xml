<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.UserMapper">
   
   <!-- 
      void insertUser(User user);
    -->
   	<insert id="insertUser" parameterType="User">
   		<selectKey keyProperty="userNo"
   					resultType="int"
   					order="BEFORE">
   			select app_users_seq.nextval
   			from dual
   		</selectKey>
   		
   		insert into app_users
   		(user_no, username, password, name, email)
   		values
   		(#{userNo}, #{username}, #{password}, #{name}, #{email})
   	</insert>
   
   <!-- 
      void insertUserRole(@Param("userNo") int userNo, @Param("roleName") String roleName);
   -->
   <insert id="insertUserRole">
   		insert into app_user_roles
   		(user_no, role_name)
   		values
   		(#{userNo}, #{roleName})
   </insert>
   
   <!-- 
      User getUserByUsername(String username); 
   -->
    <select id="getUserByUsername" resultType="User">
    	select
    		user_no userNo
    		, username
    		, password
    		, name
    		, email
    		, deleted
    		, created_date createdDate
    		, updated_date updatedDate
    	from
    		app_users
    	where 
    		username = #{username}
    </select>
   
   
   <!-- 
      User getUserByUsernameWithRoleNames(String username); 
   -->
   
   
   <!-- 
      User getUserByEmail(String email); 
   -->
   <select id="getUserByEmail" resultType="User">
    	select
    		user_no userNo
    		, username
    		, password
    		, name
    		, email
    		, deleted
    		, created_date createdDate
    		, updated_date updatedDate
    	from
    		app_users
    	where 
    		email = #{email}
    </select>
   
   
   <!-- 
      User getUserByUserNo(int userNo); 
   -->
   <select id="getUserByUserNo" resultType="User">
    	select
    		user_no userNo
    		, username
    		, password
    		, name
    		, email
    		, deleted
    		, created_date createdDate
    		, updated_date updatedDate
    	from
    		app_users
    	where 
    		user_no = #{userNo}
    </select>

   

</mapper>